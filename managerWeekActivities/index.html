<!doctype html>
<html lang="ro">

<head>
    <meta charset="UTF-8" />
    <link rel="manifest" href="/manifest.json" />
    <!-- Adaugă și o culoare pentru bara de status pe iOS -->
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Manager Săptămânal</title>
    <!-- Includem Tailwind CSS pentru un design minimalist și modern -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <style>
        /* Folosim font-ul Inter pentru un look curat */
        body {
            font-family: "Inter", sans-serif;
        }

        /* Ascundem săgețile de la input-ul de număr */
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        input[type="number"] {
            -moz-appearance: textfield;
        }

        /* Clasa 'hidden' va fi folosită de JS pentru a comuta vizibilitatea ecranelor */
        .hidden {
            display: none;
        }

        /* Stilizare Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 50;
        }
    </style>
</head>

<body class="bg-gray-100 text-gray-900 min-h-screen">
    <!-- Containerul principal al aplicației -->
    <div class="max-w-lg mx-auto p-4 bg-white min-h-screen shadow-md">
        <!-- ECRANUL 1: Lista de Spații de Lucru (Acasă) -->
        <div id="view-workspaces">
            <h1 class="text-3xl font-bold text-blue-600 mb-6">Spații de Lucru</h1>

            <!-- Formular pentru adăugare spațiu nou -->
            <form id="add-workspace-form" class="mb-6 p-4 bg-gray-50 rounded-lg shadow-sm">
                <h2 class="text-xl font-semibold mb-3">Creează un Spațiu Nou</h2>
                <div class="mb-3">
                    <label for="workspace-name" class="block text-sm font-medium text-gray-700 mb-1">Numele
                        Spațiului</label>
                    <input type="text" id="workspace-name" placeholder="Ex: Cheltuieli Proiect"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"
                        required />
                </div>
                <div class="mb-4">
                    <label for="workspace-start-day" class="block text-sm font-medium text-gray-700 mb-1">Începutul
                        Săptămânii</label>
                    <select id="workspace-start-day"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                        <option value="1">Luni</option>
                        <option value="2">Marți</option>
                        <option value="3">Miercuri</option>
                        <option value="4">Joi</option>
                        <option value="5">Vineri</option>
                        <option value="6">Sâmbătă</option>
                        <option value="0">Duminică</option>
                    </select>
                </div>
                <button type="submit"
                    class="w-full bg-blue-600 text-white font-semibold py-2 px-4 rounded-md shadow-md hover:bg-blue-700 transition duration-150">
                    Adaugă Spațiu
                </button>
            </form>

            <!-- Lista spațiilor de lucru existente -->
            <div id="workspace-list" class="space-y-3">
                <!-- Spațiile de lucru vor fi adăugate aici de JavaScript -->
                <!-- Exemplu:
                <div class="p-4 bg-white border border-gray-200 rounded-lg shadow-sm cursor-pointer hover:bg-gray-50">
                    <h3 class="text-lg font-semibold">Cheltuieli Proiect</h3>
                    <p class="text-sm text-gray-500">Începe Luni</p>
                </div>
                -->
            </div>
        </div>

        <!-- ECRANUL 2: Detalii Spațiu de Lucru (Liste) -->
        <div id="view-lists" class="hidden">
            <header class="flex items-center mb-6">
                <button id="back-to-workspaces" class="mr-3 p-2 rounded-full hover:bg-gray-200">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                </button>
                <h1 id="list-view-title" class="text-2xl font-bold text-blue-600">
                    Nume Spațiu
                </h1>
            </header>

            <!-- Secțiunea pentru lista curentă (cea mai nouă) -->
            <div id="current-list-section" class="mb-6">
                <!-- Titlul listei curente și totalul vor fi adăugate aici -->
            </div>

            <!-- Formular pentru adăugare item nou în lista curentă -->
            <!-- AM ȘTERS FORMULARUL DE AICI -->

            <!-- Istoricul listelor mai vechi -->
            <div class="mb-6">
                <h2 class="text-xl font-semibold mb-3">Istoric Liste</h2>
                <div id="history-list-section" class="space-y-2">
                    <!-- Listele vechi (sub formă de acordeon) vor fi adăugate aici -->
                </div>
            </div>

            <!-- Buton de ștergere a spațiului de lucru -->
            <button id="delete-workspace"
                class="w-full bg-red-600 text-white font-semibold py-2 px-4 rounded-md shadow-md hover:bg-red-700 transition duration-150 mt-4">
                Șterge Acest Spațiu de Lucru
            </button>

            <!-- Buton de test -->
            <!-- AM ȘTERS BUTONUL DE TEST DE AICI -->
        </div>
    </div>

    <!-- ECRANUL 3: Modal de Ștergere -->
    <div id="modal-delete" class="modal-overlay hidden">
        <div class="bg-white p-6 rounded-lg shadow-xl max-w-sm w-full mx-4">
            <h2 class="text-xl font-bold mb-4">Confirmă Ștergerea</h2>
            <p class="mb-4 text-sm text-gray-700">
                Acțiunea este ireversibilă. Pentru a confirma, te rog să scrii numele
                spațiului de lucru:
                <strong id="modal-delete-name" class="text-red-600"></strong>
            </p>
            <input type="text" id="modal-delete-input"
                class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm mb-4" autocomplete="off"
                autocapitalize="none" />
            <div class="flex justify-end space-x-3">
                <button id="modal-delete-cancel"
                    class="bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded-md hover:bg-gray-300 transition">
                    Anulează
                </button>
                <button id="modal-delete-confirm"
                    class="bg-red-600 text-white font-semibold py-2 px-4 rounded-md hover:bg-red-700 transition disabled:opacity-50 disabled:cursor-not-allowed"
                    disabled>
                    Confirmă Ștergerea
                </button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            // --- SELECTORI DOM ---
            const $ = (selector) => document.querySelector(selector);
            const $all = (selector) => document.querySelectorAll(selector);

            const viewWorkspaces = $("#view-workspaces");
            const viewLists = $("#view-lists");

            const addWorkspaceForm = $("#add-workspace-form");
            const workspaceNameInput = $("#workspace-name");
            const workspaceStartDayInput = $("#workspace-start-day");
            const workspaceList = $("#workspace-list");

            const backToWorkspacesBtn = $("#back-to-workspaces");
            const listViewTitle = $("#list-view-title");
            const currentListSection = $("#current-list-section");
            const historyListSection = $("#history-list-section");

            const addItemForm = $("#add-item-form");
            const itemNumberInput = $("#item-number");
            const itemDescriptionInput = $("#item-description");

            const deleteWorkspaceBtn = $("#delete-workspace");
            // AM ȘTERS `testAddWeekBtn`

            // Selectoare pentru modal
            const modalDelete = $("#modal-delete");
            const modalDeleteName = $("#modal-delete-name");
            const modalDeleteInput = $("#modal-delete-input");
            const modalDeleteConfirmBtn = $("#modal-delete-confirm");
            const modalDeleteCancelBtn = $("#modal-delete-cancel");

            const DB_KEY = "saptamanalDB";
            const dayNames = [
                "Duminică",
                "Luni",
                "Marți",
                "Miercuri",
                "Joi",
                "Vineri",
                "Sâmbătă",
            ];

            // --- BAZA DE DATE (LOCALĂ) ---
            let db = {
                workspaces: [],
                currentWorkspaceId: null,
            };

            // Încarcă baza de date din localStorage
            function loadDB() {
                const dbString = localStorage.getItem(DB_KEY);
                if (dbString) {
                    db = JSON.parse(dbString);
                } else {
                    // Inițializează DB-ul dacă nu există
                    db = {workspaces: [], currentWorkspaceId: null};
                    saveDB();
                }
            }

            // Salvează baza de date în localStorage
            function saveDB() {
                localStorage.setItem(DB_KEY, JSON.stringify(db));
            }

            // --- FUNCȚII UTILITARE ---

            // Generează un ID unic
            function generateId() {
                return (
                    Date.now().toString(36) + Math.random().toString(36).substr(2, 9)
                );
            }

            // Formatează o dată (ex: 10 Nov 2025)
            function formatDate(date) {
                return date.toLocaleDateString("ro-RO", {
                    day: "numeric",
                    month: "short",
                    year: "numeric",
                });
            }

            // Calculează totalul numerelor dintr-o listă
            function calculateTotal(list) {
                return list.items
                    .reduce((total, item) => total + item.number, 0)
                    .toFixed(2);
            }

            // Comută între ecrane
            function showView(viewId) {
                if (viewId === "view-lists") {
                    viewWorkspaces.classList.add("hidden");
                    viewLists.classList.remove("hidden");
                } else {
                    viewLists.classList.add("hidden");
                    viewWorkspaces.classList.remove("hidden");
                    db.currentWorkspaceId = null; // Resetează spațiul curent la întoarcere
                    saveDB();
                }
            }

            // --- RENDERARE ECRANE ---

            // Afișează toate spațiile de lucru pe ecranul principal
            function renderWorkspaces() {
                workspaceList.innerHTML = ""; // Curăță lista
                if (db.workspaces.length === 0) {
                    workspaceList.innerHTML = `<p class="text-gray-500 text-center">Nu ai încă niciun spațiu de lucru. Creează unul mai sus.</p>`;
                    return;
                }

                db.workspaces.forEach((ws) => {
                    const wsElement = document.createElement("div");
                    wsElement.className =
                        "p-4 bg-white border border-gray-200 rounded-lg shadow-sm cursor-pointer hover:bg-gray-50 transition duration-150";
                    wsElement.dataset.id = ws.id;
                    wsElement.innerHTML = `
                        <h3 class="text-lg font-semibold">${ws.name}</h3>
                        <p class="text-sm text-gray-500">Începe ${dayNames[ws.startDay]}</p>
                    `;
                    // Adaugă event listener pentru a deschide spațiul de lucru
                    wsElement.addEventListener("click", () => {
                        openWorkspace(ws.id);
                    });
                    workspaceList.appendChild(wsElement);
                });
            }

            // Afișează detaliile unui spațiu de lucru (lista curentă + istoric)
            function renderListView() {
                if (!db.currentWorkspaceId) return;

                const ws = db.workspaces.find((w) => w.id === db.currentWorkspaceId);
                if (!ws) {
                    console.error("Spațiu de lucru negăsit!");
                    showView("view-workspaces");
                    return;
                }

                // Verifică dacă trebuie creată o listă nouă
                checkAndCreateNewList(ws);

                // --- Afișează titlul ---
                listViewTitle.textContent = ws.name;

                // Curăță secțiunile
                currentListSection.innerHTML = "";
                historyListSection.innerHTML = "";

                if (ws.lists.length === 0) {
                    currentListSection.innerHTML = `<p class="text-gray-500 text-center">Acest spațiu de lucru nu are încă nicio listă.</p>`;
                    return;
                }

                // Listele sunt deja sortate (cea mai nouă e la sfârșit)
                // Creăm o copie și o inversăm pentru afișare (cea mai nouă prima)
                const listsReversed = [...ws.lists].reverse();

                // --- 1. Render Lista Curentă ---
                const currentList = listsReversed[0];
                currentListSection.appendChild(renderList(currentList, true)); // 'true' = expandată

                // --- 2. Render Istoric ---
                if (listsReversed.length > 1) {
                    const historyLists = listsReversed.slice(1); // Restul listelor
                    historyLists.forEach((list) => {
                        historyListSection.appendChild(renderList(list, false)); // 'false' = colapsată
                    });
                } else {
                    historyListSection.innerHTML = `<p class="text-gray-500 text-center text-sm">Nu există istoric.</p>`;
                }
            }

            // Funcție helper care creează HTML-ul pentru o singură listă (fie ea curentă sau istoric)
            function renderList(list, isExpanded) {
                const listContainer = document.createElement("div");
                listContainer.className =
                    "bg-white border border-gray-200 rounded-lg shadow-sm mb-3";

                const total = calculateTotal(list);

                // Folosim <details> pentru acordeon nativ
                const detailsElement = document.createElement("details");
                detailsElement.open = isExpanded; // Deschide dacă e lista curentă

                // Partea vizibilă (Titlu + Total)
                const summaryElement = document.createElement("summary");
                summaryElement.className =
                    "p-4 flex justify-between items-center cursor-pointer list-none";
                summaryElement.innerHTML = `
                    <div>
                        <h3 class="text-lg font-semibold ${isExpanded ? "text-blue-700" : ""}">${list.title}</h3>
                        <p class="text-sm text-gray-500">${formatDate(new Date(list.createdAt))}</p>
                    </div>
                    <div class="text-right">
                        <span class="text-xl font-bold text-green-600">${total}</span>
                        <span class="text-sm text-gray-500 block">Total</span>
                    </div>
                `;

                // Partea ascunsă (lista de iteme)
                const contentElement = document.createElement("div");
                contentElement.className = "p-4 border-t border-gray-200";

                if (list.items.length === 0) {
                    contentElement.innerHTML = `<p class="text-gray-500 text-sm">Nicio înregistrare în această listă.</p>`;
                } else {
                    const itemsList = document.createElement("ul");
                    itemsList.className = "space-y-2";
                    list.items.forEach((item) => {
                        const itemElement = document.createElement("li");
                        itemElement.className =
                            "flex justify-between items-center p-2 bg-gray-50 rounded-md";
                        itemElement.innerHTML = `
                            <div>
                                <span class="font-semibold text-gray-800 editable-span" contenteditable="true" data-item-id="${item.id}" data-list-id="${list.id}" data-field="number">${item.number}</span>
                                ${item.description
                                ? `<span class="text-sm text-gray-600 ml-2 editable-span" contenteditable="true" data-item-id="${item.id}" data-list-id="${list.id}" data-field="description">${item.description}</span>`
                                : `<span class="text-sm text-gray-400 ml-2 editable-span italic" contenteditable="true" data-item-id="${item.id}" data-list-id="${list.id}" data-field="description">[Fără descriere]</span>`
                            }
                            </div>
                            <button data-item-id="${item.id}" data-list-id="${list.id}" class="delete-item-btn text-red-500 hover:text-red-700 p-1 rounded-full">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />
                                </svg>
                            </button>
                        `;
                        itemsList.appendChild(itemElement);
                    });
                    contentElement.appendChild(itemsList);
                }

                // Adăugăm formularul de adăugare item direct în lista
                contentElement.appendChild(createAddItemForm(list.id));

                detailsElement.appendChild(summaryElement);
                detailsElement.appendChild(contentElement);
                listContainer.appendChild(detailsElement);

                return listContainer;
            }

            // --- LOGICA DE BUSINESS ---

            // Deschide un spațiu de lucru
            function openWorkspace(id) {
                db.currentWorkspaceId = id;
                saveDB();
                renderListView();
                showView("view-lists");
            }

            // Logica principală: Verifică dacă trebuie creată o listă nouă
            function checkAndCreateNewList(workspace) {
                const today = new Date();
                today.setHours(0, 0, 0, 0); // Normalizează la începutul zilei

                const startDay = workspace.startDay; // 0=Sun, 1=Mon...

                // Calculează data ultimei zile de start (ex. ultimul Luni)
                const lastStartDayDate = new Date(today.getTime());
                const dayDiff = (today.getDay() - startDay + 7) % 7;
                lastStartDayDate.setDate(today.getDate() - dayDiff);

                if (workspace.lists.length === 0) {
                    // Dacă nu există nicio listă, creează prima listă
                    createNewList(workspace, lastStartDayDate);
                } else {
                    // Verifică data ultimei liste
                    const lastList = workspace.lists[workspace.lists.length - 1];
                    const lastListDate = new Date(lastList.createdAt);
                    lastListDate.setHours(0, 0, 0, 0); // Normalizează

                    // Dacă ultima listă a fost creată *înainte* de ultima zi de start,
                    // înseamnă că a început o săptămână nouă.
                    if (lastListDate.getTime() < lastStartDayDate.getTime()) {
                        createNewList(workspace, lastStartDayDate);
                    }
                }
            }

            // Creează efectiv o listă nouă și o salvează
            function createNewList(workspace, date) {
                const newList = {
                    id: generateId(),
                    title: `Săptămâna ${formatDate(date)}`,
                    createdAt: date.toISOString(), // Salvăm ca string ISO
                    items: [],
                };
                workspace.lists.push(newList);
                saveDB();
            }

            // --- Funcție nouă: Creează HTML-ul pentru formularul de adăugare item ---
            function createAddItemForm(listId) {
                const formContainer = document.createElement("div");
                formContainer.className = "mt-4 pt-4 border-t border-gray-100";
                formContainer.innerHTML = `
                    <form class="add-item-form-dynamic" data-list-id="${listId}">
                        <h3 class="text-md font-semibold mb-2">Adaugă înregistrare nouă</h3>
                        <div class="flex space-x-3 mb-2">
                            <div class="flex-shrink-0 w-24">
                                <label class="block text-xs font-medium text-gray-600 mb-1">Cifră</label>
                                <input type="number" name="item-number" step="any" placeholder="10.5" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm text-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" required>
                            </div>
                            <div class="flex-grow">
                                <label class="block text-xs font-medium text-gray-600 mb-1">Descriere</label>
                                <input type="text" name="item-description" placeholder="Ex: Prânz client" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm text-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                            </div>
                        </div>
                        <button type="submit" class="w-full bg-blue-500 text-white font-semibold py-1 px-3 text-sm rounded-md shadow-sm hover:bg-blue-600 transition duration-150">Adaugă</button>
                    </form>
                `;
                return formContainer;
            }

            // --- EVENT HANDLERS ---

            // Adaugă un spațiu de lucru nou
            addWorkspaceForm.addEventListener("submit", (e) => {
                e.preventDefault();
                const name = workspaceNameInput.value.trim();
                const startDay = parseInt(workspaceStartDayInput.value, 10);

                if (name) {
                    const newWorkspace = {
                        id: generateId(),
                        name: name,
                        startDay: startDay,
                        lists: [],
                    };
                    db.workspaces.push(newWorkspace);
                    saveDB();
                    renderWorkspaces();

                    // Resetează formularul
                    workspaceNameInput.value = "";
                    workspaceStartDayInput.value = "1";
                }
            });

            // Adaugă un item nou în lista curentă
            // AM ȘTERS LISTENER-UL PENTRU `addItemForm`

            // --- Listener nou (delegat) pentru adăugarea de item-uri ---
            viewLists.addEventListener("submit", (e) => {
                if (e.target.classList.contains("add-item-form-dynamic")) {
                    e.preventDefault();
                    const form = e.target;
                    const listId = form.dataset.listId;

                    const numberInput = form.querySelector('input[name="item-number"]');
                    const descriptionInput = form.querySelector(
                        'input[name="item-description"]',
                    );

                    const number = parseFloat(numberInput.value);
                    const description = descriptionInput.value.trim();

                    if (isNaN(number) || !db.currentWorkspaceId) return;

                    const ws = db.workspaces.find(
                        (w) => w.id === db.currentWorkspaceId,
                    );
                    if (ws) {
                        const list = ws.lists.find((l) => l.id === listId);
                        if (list) {
                            const newItem = {
                                id: generateId(),
                                number: number,
                                description: description,
                            };
                            list.items.push(newItem);
                            saveDB();
                            renderListView(); // Re-afișează totul
                        }
                    }
                }
            });

            // --- Listener nou (delegat) pentru editarea item-urilor ---
            viewLists.addEventListener("focusout", (e) => {
                if (e.target.classList.contains("editable-span")) {
                    const span = e.target;
                    const {itemId, listId, field} = span.dataset;
                    let newValue = span.textContent.trim();

                    if (newValue === "[Fără descriere]") {
                        newValue = ""; // Gestionează textul placeholder
                    }

                    const ws = db.workspaces.find(
                        (w) => w.id === db.currentWorkspaceId,
                    );
                    if (!ws) return;
                    const list = ws.lists.find((l) => l.id === listId);
                    if (!list) return;
                    const item = list.items.find((i) => i.id === itemId);
                    if (!item) return;

                    if (field === "number") {
                        const newNumber = parseFloat(newValue);
                        if (isNaN(newNumber)) {
                            // Număr invalid, re-randează pentru a reseta
                            renderListView();
                            return;
                        }
                        item.number = newNumber;
                    } else if (field === "description") {
                        item.description = newValue;
                    }

                    saveDB();
                    // Re-randează pentru a actualiza totalurile și a curăța formatarea
                    renderListView();
                }
            });

            // Șterge un item dintr-o listă (folosind event delegation)
            viewLists.addEventListener("click", (e) => {
                const deleteBtn = e.target.closest(".delete-item-btn");
                if (deleteBtn) {
                    const itemId = deleteBtn.dataset.itemId;
                    const listId = deleteBtn.dataset.listId;
                    const ws = db.workspaces.find(
                        (w) => w.id === db.currentWorkspaceId,
                    );

                    if (ws) {
                        const list = ws.lists.find((l) => l.id === listId);
                        if (list) {
                            // Filtrează item-ul și salvează
                            list.items = list.items.filter((item) => item.id !== itemId);
                            saveDB();
                            renderListView(); // Re-afișează
                        }
                    }
                }
            });

            // --- Logica pentru Modalul de Ștergere ---

            // Deschide modalul de ștergere
            deleteWorkspaceBtn.addEventListener("click", () => {
                if (!db.currentWorkspaceId) return;

                const ws = db.workspaces.find((w) => w.id === db.currentWorkspaceId);
                if (!ws) return;

                // Setează numele corect în modal
                modalDeleteName.textContent = ws.name;
                // Resetează câmpul și butonul
                modalDeleteInput.value = "";
                modalDeleteConfirmBtn.disabled = true;

                // Arată modalul
                modalDelete.classList.remove("hidden");
            });

            // Butonul de anulare din modal
            modalDeleteCancelBtn.addEventListener("click", () => {
                modalDelete.classList.add("hidden");
            });

            // Verifică inputul în timp real pentru a activa butonul de confirmare
            modalDeleteInput.addEventListener("input", () => {
                if (modalDeleteInput.value === modalDeleteName.textContent) {
                    modalDeleteConfirmBtn.disabled = false;
                } else {
                    modalDeleteConfirmBtn.disabled = true;
                }
            });

            // Butonul de confirmare ștergere
            modalDeleteConfirmBtn.addEventListener("click", () => {
                // Verificare suplimentară
                if (
                    modalDeleteInput.value !== modalDeleteName.textContent ||
                    !db.currentWorkspaceId
                ) {
                    return;
                }

                db.workspaces = db.workspaces.filter(
                    (ws) => ws.id !== db.currentWorkspaceId,
                );
                db.currentWorkspaceId = null;
                saveDB();

                modalDelete.classList.add("hidden"); // Ascunde modalul
                renderWorkspaces();
                showView("view-workspaces");
            });

            <!-- AM ȘTERS BLOCUL DE COD PENTRU BUTONUL DE TEST -->

            // Butonul de întoarcere
            backToWorkspacesBtn.addEventListener("click", () => {
                showView("view-workspaces");
            });

            // --- INIȚIALIZARE ---
            function init() {
                loadDB();
                renderWorkspaces();
                showView("view-workspaces");
            }

            init();
        });
    </script>
</body>

</html>
